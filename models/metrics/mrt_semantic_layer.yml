version: 2.0

semantic_models:
  - name: mrt_semantic_layer
    defaults:
      agg_time_dimension: first_month_on_screen
    description: |
      Movies performance table. Grain is aggregated metrics on monthly level per movie per cinema. 
    model: ref('mrt_movies_performance_incl_kpis')
    entities:
      - name: movie_id
        type: primary
      - name: cinema_id
        type: foreign
    dimensions:
      - name: first_month_on_screen
        type: time
        type_params:
          time_granularity: year
      - name: movie_director
        type: categorical
      - name: movie_studio
        type: categorical
      - name: movie_pg_rating
        type: categorical
      - name: movie_length_min
        type: categorical
      - name: movie_budget_category
        type: categorical
      - name: screening_duration_in_months
        type: time
        type_params:
          time_granularity: month
    measures:   
      - name: tickets_sold
        description: The total number of movie tickets sold for this film over a year in specified cinema.
        agg: sum
        expr: amount
      - name: revenue
        description: The total revenue generated by movie tickets sold.
        agg: sum
      - name: movie_rental_costs
        description: Total costs for renting the shown movie over a year in specified cinema.
        expr: amount
        agg: sum
      - name: total_brutto_profit
        description: Total brutto profit describes revenue by tickets sold minus costs for renting the movies.
        expr: amount
        agg: sum